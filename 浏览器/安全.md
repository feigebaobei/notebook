# web安全

XSS 和 CSRF 是最常见的攻击方式

[TOC]

## xss

cross site script 跨站脚本攻击

### 攻击方式

攻击者对客户端网页注入的恶意脚本一般包括 JavaScript，有时也会包含 HTML 和 Flash。有很多种方式进行 XSS 攻击，但它们的共同点为：
将一些隐私数据像 cookie、session 发送给攻击者，将受害者重定向到一个由攻击者控制的网站，在受害者的机器上进行一些恶意操作。

#### 反射型（非持久型）

需要攻击者诱使用户点击一个恶意链接，或者提交一个表单，或者进入一个恶意网站时，注入脚本进入被攻击者的网站。这些脚本会浏览器中运行一些恶意操作。

#### 存储型（持久型）

存储型 XSS 会把用户输入的数据 “存储” 在服务器端，当浏览器请求数据时，脚本从服务器上传回并执行。这种 XSS 攻击具有很强的稳定性。
有可能对服务攻击。

#### 基于dom型

通过恶意脚本修改页面的 DOM 结构，是纯粹发生在客户端的攻击。

### 防范方式

httpOnly
检查、过滤、转义输入。`< > script & `

```
const decodingMap = {
'&lt;': '<,
'&gt;': '>,
'&quot;': '",
'&amp;': '&,
// '': '\n'
}
```
过滤html后再输出到页面。如使用sanitize-html。

## csrf

cross site request forgery 跨站点请求伪造
恶意网站在获取用户的cookie后，向被攻击服务器发送请求。被攻击服务器会认为是真实的请求，正常回馈请求。

### 防范方式

验证码。防止在用户不知情时向服务请求。
检查referer是否是信任的网址。
添加token

### 后注

referer可以防止图片盗链。



